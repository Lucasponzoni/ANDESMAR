<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Envios</title>
    
    <script>
        const userType = localStorage.getItem('userType');
        if (userType === 'placeit') {
            localStorage.setItem('accessDenied', 'true');
            window.location.replace('MeliArPlaceit.html');
        } else {
            const savedTimestamp = localStorage.getItem('loginTimestamp');
            const isExpired = !savedTimestamp || (Date.now() - savedTimestamp) > 28800000;
            if (isExpired) {
                window.location.replace('logipaq.html');
            }
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Signika:wght@300..700&family=Titan+One&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/print.js/1.6.0/print.min.css">
    <link rel="stylesheet" href="./styles.css">
    <link rel="shortcut icon" href="./Img/caja.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        /* Estilo específico para esta página */
        .search-container-top {
            max-width: 90%; /* Aumentar ancho del contenedor de búsqueda */
        }

        #cards-container {
            max-width: 90%; /* Aumentar ancho del contenedor de tarjetas */
        }

        /* Media query para pantallas de 950px o menos */
        @media (max-width: 992px) {
            .search-container-top,
            #cards-container {
                max-width: 100%; /* Cambiar a 100% en pantallas pequeñas */
            }
        }
    </style>
</head>

<body class="envios-body">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="./Img/Novogar N.png" alt="Logo" class="navbar-logo">
                <span class="navbar-brand-text">L<span class="navbar-brand-text4">gi</span><span class="navbar-brand-text2">Paq</span> <img class="blackCat" src="./Img/Location.gif" alt="LogiPaq" srcset=""> </span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a href="./index.html" class="nav-link">Etiquetado</a></li>
                    <li class="nav-item"><a href="./envios.html" class="nav-link">Envios Andesmar</a></li>
                    <li class="nav-item"><a href="./despachos.html" class="nav-link">Logistica</a></li>
                    <li class="nav-item"><a href="./bna.html" class="nav-link">Tiendas Virtuales</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            MeLi <img id="meli-logo" src="./Img/meli.png">
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="./facturacionMl.html">Facturacion Mercado libre</a>
                            <a class="dropdown-item" href="./meliAr.html">Envios Mercado Libre</a>
                            <a class="dropdown-item" href="./controlMeli.html">Colecta Mercado libre</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Más
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item active" href="./tipeoWeb.html">Despacho Logistico</a>
                            <a class="dropdown-item" href="./MeliArPlaceit.html">Mercado Libre PlaceIt</a>
                            <a class="dropdown-item" href="./bnaPlaceIt.html">Tiendas Virtuales PlaceIt</a>
                            <a class="dropdown-item" href="./simbel.html">Venta Web PlaceIt</a>
                            <a class="dropdown-item" href="./panelPlaceIt.html"><i class="bi bi-gear-fill mr-1"></i>Panel PlaceIt</a>
                            <a class="dropdown-item" href="./catalogo.html">Catalogo de Productos</a>
                            <a class="dropdown-item" href="./etiquetaSimbel.html">Etiqueta WEB PlaceIt</a>
                            <a class="dropdown-item" href="./jsonSimbel.html">Export Json Simbel</a>
                            <a class="dropdown-item" href="./posventa.html">Posventa</a> 
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<div class="container mt-4 search-container-top">

    <div class="row justify-content-between align-items-center search-filter-container">
        <!-- Input de búsqueda -->
        <div class="col-12 col-md-6 mb-2">
            <div class="input-group">
                <input type="text" class="form-control" id="searchDespachosLogistica" placeholder="Buscar por cliente o Remito...">
                <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="button">
                        <i class="fas fa-search" style="font-size: 22px;"></i>
                    </button>
                </div>
            </div>

            <!-- Link Búsqueda Avanzada debajo del input -->
            <div class="mt-1">
                <a href="#" id="toggleAdvancedSearch" style="font-size: 12px; color: #007aff; text-decoration: none;">Búsqueda Avanzada ▼</a>
            </div>
        </div>

        <!-- Búsqueda Avanzada Opciones (Siempre debajo, 100% ancho) -->
        <div class="col-12 mb-2" id="advancedSearchOptions" style="display: none; padding: 10px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9; font-size: 12px;">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="filterByDate">
                <label class="form-check-label" for="filterByDate">Filtrar por Fecha</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="filterByStatus">
                <label class="form-check-label" for="filterByStatus">Solo pendientes</label>
            </div>
            <!-- Más filtros si querés -->
        </div>

        <!-- Botonera -->
        <div class="col-12 mb-3 d-flex justify-content-end ingreso-egreso" style="overflow-x: auto; white-space: nowrap;">
            <div style="min-width: 100%;">
                <button class="btn btn-dark" id="btnVolverAtras" type="button" title="Volver atrás" style="display: none;">
                    <i class="bi bi-arrow-return-left" style="font-size: 22px;"></i> Atrás
                </button>
                <button class="btn btn-light" id="btnIniciarEscaneo" type="button" data-bs-toggle="modal" data-bs-target="#modalDespacho">
                    <i class="bi bi-clipboard-pulse" style="font-size: 22px; color: #a517be;"></i> Iniciar Escaneo
                </button>
                <button class="btn btn-light" id="btnEstadisticas" type="button" data-bs-toggle="modal" data-bs-target="#modalEstadisticas">
                    <i class="bi bi-bar-chart" style="font-size: 22px; color: #1776be;"></i> Estadísticas
                </button>
                <button class="btn btn-light" id="btnBuscarInfoRemitos" type="button">
                    <i class="bi bi-binoculars-fill" style="font-size: 22px; color: #fb8e00;"></i> Buscar Remitos
                </button>
                <button class="btn btn-light position-relative" id="btnAdjuntarDocumentacion" type="button" data-bs-toggle="modal" data-bs-target="#modalDocumentacion">
                    <i class="bi bi-paperclip" style="font-size: 22px; color: #17be5e;"></i> Adjuntar documentación
                    <span id="contadorDocumentacionFaltante" class="badge badge-light position-absolute top-0 start-100 translate-middle rounded-pill ios-badge">
                        <i class="fas fa-spinner fa-spin"></i>
                    </span>
                </button>
                <button class="btn btn-primary btn-seguro" id="btnReporteSeguro" type="button">
                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true" id="spinnerSeguro"></span>
                    <i class="bi bi-shield-lock-fill" style="font-size: 22px; color: #f6ff00;" id="iconoSeguro"></i>
                    <span id="textoSeguro">Reporte de Seguro</span>
                </button>
                <!-- Input invisible para flatpickr -->
                <input type="text" id="inputFlatpickrSeguro" class="input-flatpickr-temp" 
                    style="opacity:0; width:1px; height:1px; border:none; padding:0; margin:0; position:relative; z-index:10;" />
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('toggleAdvancedSearch').addEventListener('click', function(e) {
        e.preventDefault();
        const adv = document.getElementById('advancedSearchOptions');
        adv.style.display = (adv.style.display === 'none') ? 'block' : 'none';
        this.innerHTML = (adv.style.display === 'block') ? 'Ocultar Búsqueda Avanzada ▲' : 'Búsqueda Avanzada ▼';
    });
</script>

    <div class="container mt-5" id="cards-container">                   

<!-- CONTENEDORES TIPEO -->
<div class="contenedor-macos-tipeo">

    <!-- Andreani -->
    <div class="tarjeta-tipeo rojo-tipeo">
      <img src="./Img/andreani-mini.png" class="imagen-top-tipeo" alt="Andreani" />
      <div class="bloque-info-tipeo">
        <i class="bi bi-box-seam-fill icono-tipeo"></i>
        <span class="texto-etiquetas">Etiquetas:</span>
        <span class="numero-tipeo total-andreani">
          <i class="fas fa-spinner fa-spin"></i>
        </span>
      </div>      
      <div class="bloque-info-tipeo-doble">
        <div class="bloque-info-tipeo">
            <i class="bi bi-arrows-angle-expand icono-tipeo"></i>
            <span class="numero-tipeo total-bigger-andreani"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
          <div class="bloque-info-tipeo">
            <i class="bi bi-arrows-angle-contract icono-tipeo"></i>
            <span class="numero-tipeo total-paqueteria-andreani"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="bloque-info-tipeo-doble">
          <div class="bloque-info-tipeo total-monto-contenedor">
            <i class="bi bi-bank icono-tipeo"></i>
            <span class="numero-tipeo total-monto-andreani"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="botones-tipeo">
        <button class="btn btn-light btn-sm emailAndreani" data-logistica="Andreani" data-toggle="modal" data-target="#EmailModal">
            <i class="bi bi-envelope-fill"></i>
        </button>
        <button class="btn btn-light btn-sm modal-andreani" 
            data-logistica="Andreani" 
            onclick="abrirModalTabla('Andreani')">
            <i class="bi bi-arrows-fullscreen"></i>
        </button>
        <button class="btn btn-light btn-sm historial-Andreani"><i class="bi bi-graph-up"></i></button>
      </div>
    </div>
  
    <!-- Andesmar -->
    <div class="tarjeta-tipeo azul-tipeo">
      <img src="./Img/andesmar-mini.png" class="imagen-top-tipeo" alt="Andesmar" />
      <div class="bloque-info-tipeo">
        <i class="bi bi-box-seam-fill icono-tipeo"></i>
        <span class="texto-etiquetas">Etiquetas:</span>
        <span class="numero-tipeo total-andesmar"><i class="fas fa-spinner fa-spin"></i></span>
      </div>
      <div class="bloque-info-tipeo-doble">
        <div class="bloque-info-tipeo">
            <i class="bi bi-arrows-angle-expand icono-tipeo"></i>
            <span class="numero-tipeo total-bigger-andesmar"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="bloque-info-tipeo-doble">
          <div class="bloque-info-tipeo total-monto-contenedor">
            <i class="bi bi-bank icono-tipeo"></i>
            <span class="numero-tipeo total-monto-andesmar"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="botones-tipeo">
        <button class="btn btn-light btn-sm emailAndesmar" data-logistica="Andesmar" data-toggle="modal" data-target="#EmailModal">
            <i class="bi bi-envelope-fill"></i>
        </button>
        <button class="btn btn-light btn-sm modal-Andesmar" 
            data-logistica="Andesmar" 
            onclick="abrirModalTabla('Andesmar')">
            <i class="bi bi-arrows-fullscreen"></i>
        </button>
        <button class="btn btn-light btn-sm historial-Andesmar"><i class="bi bi-graph-up"></i></button>
      </div>
    </div>
  
    <!-- OCA -->
    <div class="tarjeta-tipeo lila-tipeo">
      <img src="./Img/oca-mini.png" class="imagen-top-tipeo" alt="OCA" />
      <div class="bloque-info-tipeo">
        <i class="bi bi-box-seam-fill icono-tipeo"></i>
        <span class="texto-etiquetas">Etiquetas:</span>
        <span class="numero-tipeo total-oca"><i class="fas fa-spinner fa-spin"></i></span>
      </div>
      <div class="bloque-info-tipeo-doble">
        <div class="bloque-info-tipeo">
            <i class="bi bi-arrows-angle-expand icono-tipeo"></i>
            <span class="numero-tipeo total-bigger-oca"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="bloque-info-tipeo-doble">
          <div class="bloque-info-tipeo total-monto-contenedor">
            <i class="bi bi-bank icono-tipeo"></i>
            <span class="numero-tipeo total-monto-oca"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="botones-tipeo">
        <button class="btn btn-light btn-sm emailOca" data-logistica="Oca" data-toggle="modal" data-target="#EmailModal">
            <i class="bi bi-envelope-fill"></i>
        </button>
        <button class="btn btn-light btn-sm modal-Oca" 
            data-logistica="Oca" 
            onclick="abrirModalTabla('Oca')">
            <i class="bi bi-arrows-fullscreen"></i>
        </button>
        <button class="btn btn-light btn-sm historial-oca"><i class="bi bi-graph-up"></i></button>
      </div>
    </div>
  
    <!-- CDS -->
    <div class="tarjeta-tipeo azul-oscuro-tipeo">
      <img src="./Img/cds-mini.png" class="imagen-top-tipeo" alt="CDS" />
      <div class="bloque-info-tipeo">
        <i class="bi bi-box-seam-fill icono-tipeo"></i>
        <span class="texto-etiquetas">Etiquetas:</span>
        <span class="numero-tipeo total-cds"><i class="fas fa-spinner fa-spin"></i></span>
      </div>
      <div class="bloque-info-tipeo-doble">
        <div class="bloque-info-tipeo">
            <i class="bi bi-arrows-angle-expand icono-tipeo"></i>
            <span class="numero-tipeo total-bigger-cds"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="bloque-info-tipeo-doble">
          <div class="bloque-info-tipeo total-monto-contenedor">
            <i class="bi bi-bank icono-tipeo"></i>
            <span class="numero-tipeo total-monto-cds"><i class="fas fa-spinner fa-spin"></i></span>
          </div>
      </div>
      <div class="botones-tipeo">
        <button class="btn btn-light btn-sm emailCDS" data-logistica="CDS" data-toggle="modal" data-target="#EmailModal">
            <i class="bi bi-envelope-fill"></i>
        </button>
        <button class="btn btn-light btn-sm modal-cds" 
            data-logistica="Cruz del Sur" 
            onclick="abrirModalTabla('Cruz del Sur')">
            <i class="bi bi-arrows-fullscreen"></i>
        </button>
        <button class="btn btn-light btn-sm historial-cds"><i class="bi bi-graph-up"></i></button>
      </div>
    </div>
  </div>  
  <!-- FIN CONTENEDORES TIPEO -->

  <style>
    .table th, .table td {
    white-space: nowrap;
    }

    .table i {
        margin-right: 5px;
    }
  </style>

<!-- TABLA -->
<div class="table-responsive">
    <table class="table table-bordered table-striped">
        <thead class="thead-dark">
            <tr>
                <th><i class="bi bi-calendar-event"></i> Fecha y hora</th>
                <th><i class="bi bi-truck"></i></th>
                <th><i class="bi bi-link-45deg"></i> Seguimiento</th>
                <th><i class="bi bi-box-seam"></i> Bultos</th>
                <th><i class="bi bi-receipt"></i> Remito</th>
                <th><i class="bi bi-cash"></i> Valor</th>
                <th><i class="bi bi-info-circle"></i> Info</th>
                <th><i class="bi bi-trash3-fill"></i></th>
            </tr>
        </thead>
        <tbody id="tabla-despacho-body">
            <!-- Aquí se llenarán las filas dinámicamente -->
        </tbody>
    </table>
</div>
<!-- TABLA -->

<!-- SPINNER -->
<div class="spinner-border spinner-border37892 mt-2" role="status" id="spinner">
    <img src="./Img/Novogar N.png" alt="Imagen" class="spinner-image">
    <span class="sr-only">Cargando...</span>
</div>
<!-- FIN SPINNER -->        
    </div>   

    <div id="spinner2" class="spinner-container" style="display:none;">
        <img src="./Img/etiqueta-animada.gif" alt="Cargando...">
    </div>

    <!-- Botón de flecha hacia arriba -->
    <a href="#" id="scrollToTop" class="btn btn-warning" style="display: none;">
        <i class="fas fa-arrow-up"></i>
    </a>

    <!-- Botón de flecha hacia Abajo -->
    <a href="#" id="scrollToDown" class="btn btn-warning" style="display: none;">
        <i class="fas fa-arrow-down"></i>
    </a>

    <!-- Modal para Agregar Emails -->
    <div class="modal fade" id="EmailModal" tabindex="-1" role="dialog" aria-labelledby="EmailModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header sku-modal-header">
                    <h5 class="modal-title sku-modal-title" id="modalTitle">Emails de notificaciones</h5>
                    <button type="button" class="btn-danger btn-close" data-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button>
                </div>
                <div class="modal-body">
                    <div class="sku-input-group">
                        <input type="text" class="form-control" id="newEmailPorLogistica" placeholder="Ingrese el Email">
                        <button id="addEmailPorLogistica" class="btn btn-primary">Agregar</button>
                    </div>
                    <div class="spinner-border" id="loadingSpinnerPlaceIt" role="status" style="display: none;">
                        <span class="sr-only">Cargando...</span>
                    </div>
                    <div id="alertContainerEmail" style="display: none;"></div>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="EmailBody">
                            <!-- Los Emails se cargarán aquí -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- Fin Modal para Agregar Emails -->

    <!-- Modal Estadisticas -->
    <div class="modal fade" id="modalEstadisticas" tabindex="-1" role="dialog" aria-labelledby="modalEstadisticasLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header sku-modal-header">
                    <h5 class="modal-title sku-modal-title" id="modalEstadisticasLabel">📊 Estadísticas Avanzadas de Despachos</h5>
                    <button type="button" class="btn-danger btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button>
                </div>
                <div class="modal-body">

        <!-- Sección de Filtros -->
        <div class="row mr-2 mb-4 g-3 align-items-center filtros-macos-estadisticas">
            <div class="d-inline-block me-2">
                <div class="input-group input-group-lg">
                    <input type="text" class="form-control" id="rangoFechas" placeholder="Seleccionar rango">
                </div>
            </div>
            <div class="d-inline-block me-2 ml-1">
                <select class="form-select form-select-lg" id="selectLogistica">
                    <option value="todas">📦 Todas las logísticas</option>
                    <option value="Andesmar">🚛 Andesmar</option>
                    <option value="Andreani">✉️ Andreani</option>
                    <option value="CruzdelSur">🚚 Cruz del Sur</option>
                    <option value="Oca">📦 OCA</option>
                </select>
            </div>
            <div class="d-inline-block me-2 ml-1">
                <select class="form-select form-select-lg" id="selectTipoGrafico">
                    <option value="bar">📊 Barras</option>
                    <option value="line">📈 Líneas</option>
                    <option value="pie">🥧 Circular</option>
                    <option value="doughnut">🍩 Dona</option>
                    <option value="radar">🛰 Radar</option>
                </select>
            </div>
            <div class="d-inline-block me-2 ml-1">
                <select class="form-select form-select-lg" id="selectTop">
                    <option value="10">Top 10</option>
                    <option value="20">Top 20</option>
                    <option value="50">Top 50</option>
                    <option value="100">Top 100</option>
                </select>
            </div>
            <div class="d-inline-block me-2 ml-2">
                <button class="btn btn-success" id="btnFiltrar">
                    <i class="bi bi-funnel-fill"></i> Aplicar Filtros
                </button>
            </div>
        </div>

        <div class="container-fluid d-flex justify-content-center align-items-center mb-3">
            <div id="spinnerbtnFiltrar" class="spinner-border text-success" style="width: 3rem; height: 3rem; display: none;" role="status">
                <span class="sr-only">Cargando...</span>
            </div>
        </div>

        <!-- Sección de Resumen -->
        <div class="row mb-4">
            <div class="col-12 col-md-3">
                <div class="card resumen-macos bg-pastel-pink h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-truck"></i> Camiones</h5>
                        <h2 class="card-text" id="totalCamiones"><i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;"></i>Seleccione Datos</h2>
                        <small id="detalleCamiones">Por logística</small>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-3">
                <div class="card resumen-macos bg-pastel-green h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-box-seam"></i> Envíos</h5>
                        <h2 class="card-text" id="totalEnvios"><i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;"></i>Seleccione Datos</h2>
                        <small id="detalleEnvios">Por logística</small>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-3">
                <div class="card resumen-macos bg-pastel-blue h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-boxes"></i> Bultos</h5>
                        <h2 class="card-text" id="totalBultos"><i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;"></i>Seleccione Datos</h2>
                        <small id="detalleBultos">Por logística</small>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-3">
                <div class="card resumen-macos bg-pastel-yellow h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-currency-dollar"></i> Valor Total</h5>
                        <h2 class="card-text" id="valorTotal"><i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;"></i>Seleccione Datos</h2>
                        <small id="detalleValor">Por logística</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sección de Controles de Gráficos -->
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="btn-group w-100">
                    <button class="btn btn-outline-secondary active" data-grafico="productos">
                        <i class="bi bi-box-seam"></i> Productos
                    </button>
                    <button class="btn btn-outline-secondary" data-grafico="localidades">
                        <i class="bi bi-geo-alt"></i> Localidades
                    </button>
                    <button class="btn btn-outline-secondary" data-grafico="provincias">
                        <i class="bi bi-map"></i> Provincias
                    </button>
                    <button class="btn btn-outline-secondary" data-grafico="logisticas">
                        <i class="bi bi-truck"></i> Logísticas
                    </button>
                </div>
            </div>
        </div>

        <!-- Sección de Gráfico Principal -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="h-100 grafico-macos">
                    <div class="card-header d-flex justify-content-between">
                        <h5 class="card-title mb-0" id="tituloGrafico1">🏆 Productos más enviados</h5>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Opciones
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" data-action="exportar" data-grafico="1">Exportar imagen</a></li>
                                <li><a class="dropdown-item" href="#" data-action="ampliar" data-grafico="1">Ampliar</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="loadingGrafico1" class="text-center py-5" style="display: none;">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden"></span>
                            </div>
                            <p class="text-muted mt-2">Generando gráfico...</p>
                        </div>
                        <div id="errorGrafico1" class="alert alert-danger" style="display: none;"></div>
                        <div class="chart-container" style="position: relative; height:300px;">
                            <canvas id="graficoPrincipal"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sección de Controles Comparativa -->
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="btn-group w-100">
                    <button class="btn btn-outline-secondary active" data-grafico="comparativa">
                        <i class="bi bi-bar-chart-line"></i> Comparativa
                    </button>
                    <button class="btn btn-outline-secondary" data-grafico="apiladoYbultos">
                        <i class="bi bi-bar-chart"></i> Comparativa por Valor y Bultos
                    </button>
                </div>
            </div>
        </div>

        <!-- Sección de Gráfico Comparativo -->
        <div class="row">
            <div class="col-md-12">
                <div class="h-100 grafico-macos">
                    <div class="card-header d-flex justify-content-between">
                        <h5 class="card-title mb-0" id="tituloGrafico2">ℹ️ Comparativa por logística</h5>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Opciones
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" data-action="exportar" data-grafico="2">Exportar imagen</a></li>
                                <li><a class="dropdown-item" href="#" data-action="ampliar" data-grafico="2">Ampliar</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="loadingGrafico2" class="text-center py-5" style="display: none;">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden"></span>
                            </div>
                            <p class="text-muted mt-2">Generando gráfico...</p>
                        </div>
                        <div id="errorGrafico2" class="alert alert-danger" style="display: none;"></div>
                        <div class="chart-container" style="position: relative; height:300px;">
                            <canvas id="graficoSecundario"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                    <!-- Sección de Informe Detallado -->
                    <div class="row mt-4">
                        <div class="col-md-12">
                            <div class="informe-macos">
                                <div class="card-header d-flex justify-content-between">
                                    <h5 class="card-title mb-0"><i class="bi bi-file-text"></i> Informe Detallado</h5>
                                    <button class="btn btn-sm btn-success" id="btnCopiarInforme">
                                        <i class="bi bi-clipboard"></i> Copiar
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div id="reporteDetallado" style="white-space: pre-line;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div> <!-- modal-body -->
            </div> <!-- modal-content -->
        </div> <!-- modal-dialog -->
    </div>
    <!-- Fin Modal Estadisticas -->

    <!-- Modal -->
    <div class="modal fade" id="modalDespacho" tabindex="-1" role="dialog" aria-labelledby="modalDespachoLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header sku-modal-header">
                    <h5 class="modal-title sku-modal-title" id="modalDespachoLabel">Agregar Datos de Despacho</h5>
                    <button type="button" class="btn-danger btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button>
                </div>
                <div class="modal-body">
                    <form id="formDespacho">
                        <div class="mb-3">
                            <label for="inputRemito" class="form-label">Número de Remito 📦</label>
                            <input type="text" class="form-control" id="inputRemito" required>
                            <div class="invalid-feedback">Remito inválido. Debe iniciar con 83, 89, 230, 231, 233 o 254 y tener entre 10 y 11 caracteres.</div>
                        </div>
                        <div class="mb-3">
                            <label for="inputEtiqueta" class="form-label">Número de Etiqueta 🏷️</label>
                            <input type="text" class="form-control" id="inputEtiqueta" required>
                            <div class="invalid-feedback">Etiqueta inválida o formato desconocido.</div>
                        </div>
                        <div class="mb-3">
                            <label for="inputBultos" class="form-label">Número de Bultos 📦📦</label>
                            <input type="number" class="form-control" id="inputBultos">
                        </div>
                        <div class="mb-3">
                            <label for="inputValor" class="form-label">Valor Declarado 💵</label>
                            <input type="text" class="form-control" id="inputValor" required>
                            <div class="invalid-feedback">Valor inválido.</div>
                        </div>
                        <div class="mb-3">
                            <label for="inputLogistica" class="form-label">Logística 🚚</label>
                            <input type="text" class="form-control" id="inputLogistica" disabled>
                        </div>

                        <!-- Nuevo mensaje y checkbox -->
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                            <!-- Primera sección: Despacho de repuesto -->
                            <div class="mb-3" style="font-size: 0.9em; color: #555; text-align: center; width: 48%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <p>¿Vas a despachar un repuesto?</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkboxRepuesto">
                                </div>
                            </div>
                            
                            <!-- Segunda sección: Múltiples etiquetas -->
                            <div class="mb-3" style="font-size: 0.9em; color: #555; text-align: center; width: 48%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <p>¿Posee múltiples etiquetas?</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkboxEtiquetas">
                                </div>
                            </div>
                        </div>
                    </form>                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="btnAgregarDespacho">Agregar a tabla</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->

    <script>
        // Manejo del checkbox de repuesto
        document.getElementById('checkboxRepuesto').addEventListener('change', function() {
            const remitoInput = document.getElementById('inputRemito');
            const etiquetaInput = document.getElementById('inputEtiqueta'); 

            if (this.checked) {
                // Verificar si el remito ya existe
                let remitoBase = '23000006572';
                let remitoFinal = remitoBase;
                let contador = 0;

                const remitosExistentes = Array.from(document.querySelectorAll('.remito-tipeo-os')); 

                let remitoExistente = remitosExistentes.some(remito => {
                    return remito.textContent.trim() === remitoFinal; 
                });

                while (remitoExistente) {
                    contador++;
                    remitoFinal = (parseInt(remitoBase) + contador).toString(); 
                    remitoExistente = remitosExistentes.some(remito => {
                        return remito.textContent.trim() === remitoFinal;
                    });
                }

                remitoInput.value = remitoFinal;
                etiquetaInput.focus(); 
            } else {
                remitoInput.value = ''; 
            }
        });

        // Manejo del checkbox de múltiples etiquetas
        document.getElementById('checkboxEtiquetas').addEventListener('change', function() {
            const remitoInput = document.getElementById('inputRemito');
            
            if (this.checked) {
                remitoInput.focus(); // Hace focus en el input de remito al activar el checkbox
                remitoInput.value = ''; // Limpia el valor si es necesario
            }
            // No necesitamos else aquí ya que no queremos hacer nada al desactivar
        });
    </script>

    <!-- Modal Impresion -->
    <div class="modal fade" id="modalDespachoPorLogistica" tabindex="-1" role="dialog" aria-labelledby="modalDespachoPorLogisticaLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header sku-modal-header">
                    <h5 class="modal-title sku-modal-title" id="modalDespachoPorLogisticaLabel">Datos de Despacho</h5>
                    <button type="button" class="btn-danger btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button>
                </div>    
                <div class="modal-footer" style="margin-bottom: -45px; z-index: 1000;">
                    <button id="btnImprimirTabla" class="btn btn-outline-dark me-2" onclick="imprimirTabla()">
                        <i class="bi bi-printer-fill"></i> Imprimir
                    </button>
                    <button id="btnDescargarExcel" class="btn btn-outline-success me-2" onclick="descargarTablaExcel()">
                        <i class="bi bi-file-earmark-spreadsheet-fill"></i> Descargar Tabla en Excel
                    </button>
                    <button id="btnFinalizarColecta" class="btn btn-outline-danger" onclick="finalizarColecta()">
                        <i class="bi bi-x-circle-fill"></i> Finalizar Colecta
                    </button>
                </div>                                      
                <div class="modal-body">
                    <div id="spinnerPorLogistica" class="spinner-border text-primary mt-3" role="status" style="display: none; margin: auto; width: 3rem; height: 3rem;"></div>                    
                    <div class="table-responsive" id="tabla-container-xLogistica" style="display: none;">
                        <table class="table table-bordered table-striped" id="tablaDespacho">
                            <thead class="thead-dark">
                                <tr>
                                    <th><i class="bi bi-calendar-event"></i> Fecha y hora</th>
                                    <th><i class="bi bi-truck"></i></th>
                                    <th><i class="bi bi-link-45deg"></i> Seguimiento</th>
                                    <th><i class="bi bi-box-seam"></i> Bultos</th>
                                    <th><i class="bi bi-receipt"></i> Remito</th>
                                    <th><i class="bi bi-cash"></i> Valor</th>
                                    <th><i class="bi bi-info-circle"></i> Info</th>
                                    <th><i class="bi bi-trash3-fill"></i></th>
                                </tr>
                            </thead>
                            <tbody id="tabla-despacho-xLogistica-body">
                                <!-- Aquí se llenarán las filas dinámicamente -->
                            </tbody>
                        </table> 

                        <div class="pie-por-hoja-print" style="display: none;">
                            <div class="firma-container">
                                <div class="firma-bloque">
                                    <h5 class="mb-3">Datos del Transportista</h5>
                                    <p>Firma: ________________________________</p>
                                    <p>Aclaracion: ___________________________</p>
                                    <p>Fecha: <span class="fecha-impresion"></span></p>
                                </div>
                                <div class="firma-bloque">
                                    <h5 class="mb-3">Datos del Preparador</h5>
                                    <p>Firma: ________________________________</p>
                                    <p>Aclaracion: ___________________________</p>
                                    <p>Fecha: <span class="fecha-impresion"></span></p>
                                </div>
                            </div>
                        </div>                                      

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Fin Modal Impresion -->

<!-- CSS IMPORT MODAL IMPRESION -->
<style>
@media print {
    .pie-por-hoja-print {
        display: block !important;
        page-break-after: always;
        margin-top: 64px;
        padding-top: 24px;
        border-top: 2px solid rgba(0, 0, 0, 0.2);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
        font-size: 14px;
        color: #111;
    }

    .firma-container {
        display: flex;
        justify-content: space-between;
        gap: 64px;
        border: 2px solid rgba(0, 0, 0, 0.3);
        padding: 48px;
        border-radius: 16px;
        background-color: #fff;
    }

    .firma-bloque {
        flex: 1;
    }

    .firma-bloque h5 {
        font-size: 18px;
        font-weight: 700;
        text-decoration: underline;
        margin-bottom: 16px;
        color: #000;
    }

    .firma-bloque p {
        margin: 12px 0;
        font-size: 16px;
        line-height: 1.8;
    }

    #btnImprimirTabla,
    .modal-footer,
    .btn-close {
        display: none !important;
    }

        /* CIRCULOS LOGISTICA */
        .logistica-circulo {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px;
            height: 40px;
            background: linear-gradient(to bottom right, rgba(255,255,255,0.4), rgba(255,255,255,0));
            box-shadow: inset 0 1px 1px rgba(255,255,255,0.3),
                        0 1px 3px rgba(0,0,0,0.2);
            border-radius: 50%;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease-in-out;
        }

        .logistica-circulo img {
            width: 75%;
            height: auto;
            filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.3));
        }

        .andreani-tablita {
            background: linear-gradient(to bottom, #D32F2F, #B71C1C);
            border: 1px solid #E57373;
        }

        .andesmar-tablita {
            background: linear-gradient(to bottom, #1976D2, #0D47A1);
            border: 1px solid #64B5F6;
        }

        .oca-tablita {
            background: linear-gradient(to bottom, #7B1FA2, #4A148C);
            border: 1px solid #BA68C8;
        }

        .cruz-del-sur-tablita {
            background: linear-gradient(to bottom, #0D47A1, #002171);
            border: 1px solid #42A5F5;
        }

        .logistica-texto {
            display: none;
        }

        .logistica-contenedor {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* FIN CIRCULOS LOGISTICA */

        /* BULTOS LOGISTICA */
        .bultos-tabla-despacho .bultos-box {
            padding: 6px 12px 6px 38px; /* espacio para el ícono */
            border: 1px solid;
            border-radius: 8px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-weight: 600;
            text-align: left;
            display: inline-block;
            min-width: 50px;
            font-size: 15px;
            position: relative;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Círculo + emoji */
        .bultos-tabla-despacho .bultos-box::before {
            content: "✔️";
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            width: 22px;
            height: 22px;
            background-color: #ccc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: normal;
        }
        
        /* Estilo para bultos = 1 */
        .bultos-tabla-despacho .bultos-box[data-bultos="1"] {
            background-color: #f2f2f2;
            color: #333;
            border-color: #999;
        }
        .bultos-tabla-despacho .bultos-box[data-bultos="1"]::before {
            content: "➖";
            background-color: lightgray; /* verde */
            color: #fff;
        }
        
        /* Estilo para bultos > 1 */
        .bultos-tabla-despacho .bultos-box[data-bultos]:not([data-bultos="1"]) {
            background-color: #ffe6e6;
            color: #a00000;
            border-color: #d00000;
        }
        .bultos-tabla-despacho .bultos-box[data-bultos]:not([data-bultos="1"])::before {
            content: "➕";
            background-color: #ec91a1;
            color: #fff;
        }
        /* FIN BULTOS LOGISTICA */

        .valor-tabla-despacho {
            color: #388e3c;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            text-align: center;
            font-weight: bold;
            margin: 0 auto;
        }

        .remito-tabla-despacho {
            color: #727272 !important;
            font-weight: bold;
        }

        .seguimiento-contenedor {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #1e1e1e;
            padding: 10px 16px;
            border: 1px solid rgba(200, 200, 200, 0.4);
            border-radius: 12px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            text-align: center;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, background-color 0.3s ease, box-shadow 0.3s ease;
            width: fit-content;
            margin: 0 auto;
        }

        .seguimiento-contenedor a {
            text-decoration: none;
            color: #007aff;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .seguimiento-contenedor a i {
            font-size: 1.1em;
        }

        .seguimiento-contenedor:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: scale(1.04);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.08);
            cursor: pointer;
        }

    }
    </style>
    <!-- FIN CSS IMPORT MODAL IMPRESION -->    
    
    <script>
        modalDespacho.addEventListener('shown.bs.modal', () => {
        // Limpiar los campos
        document.getElementById('inputRemito').value = '';
        document.getElementById('inputEtiqueta').value = '';
        document.getElementById('inputBultos').value = '';
        document.getElementById('inputValor').value = '';
        document.getElementById('inputLogistica').value = '';
        document.getElementById('inputBultos').disabled = false;
        document.getElementById('inputRemito').focus();
        });
    </script>

<!-- CARGA DOCUMENTACION DE DESPACHO -->
<!-- Modal Documentación Pendiente -->
<div class="modal fade" id="modalDocumentacion" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-mac modal-lg">
        <div class="modal-content modal-mac">
            <div class="modal-header modal-mac-header">
                <h5 class="modal-title">
                    <i class="bi bi-files me-2 MR-1"></i>
                    Documentación Pendiente
                </h5>
                <button type="button" class="btn-danger btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body modal-mac-body p-0">
                <div class="mac-scroll-container" style="max-height: 65vh;">
                    <div class="mac-logistica-container" id="contenidoDocumentacion">
                        <!-- Contenido dinámico -->
                    </div>
                </div>
            </div>
            <div class="modal-footer modal-mac-footer">
            </div>
        </div>
    </div>
</div>

<!-- Modal Cargar Documento -->
<div class="modal fade" id="modalCargarDocumento" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-mac modal-lg">
        <div class="modal-content modal-mac">
            <div class="modal-header modal-mac-header">
                <h5 class="modal-title" id="modalCargarDocumentoLabel">
                    <i class="bi bi-cloud-arrow-up me-2 mr-2"></i>
                    <span id="tituloDocumento">Cargar Documentación</span>
                </h5>
                <button type="button" class="btn-danger btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body modal-mac-body">
                <div class="mac-alert mb-3">
                    <i class="bi bi-info-circle-fill me-2 mr-2"></i>
                    Toma fotos claras de cada hoja del documento y verificar fecha
                </div>
                
                <div class="row g-3" id="contenedorHojas">
                    <!-- Se agregarán dinámicamente las hojas aquí -->
                </div>
                
                <div class="progress-container mt-4">
                    <div class="progress-bar-mac" id="progressBarDoc" style="width: 0%">
                        <span class="progress-text ml-2">0%</span>
                    </div>
                    <div class="status-text" id="statusText"></div>
                </div> 
            </div>
            <div class="modal-footer modal-mac-footer">
                <button type="button" class="btn btn-mac-danger" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-2 mr-1"></i> Cancelar
                </button>
                <button type="button" class="btn btn-mac-primary" id="btnSubirDocumentacion" disabled>
                    <span class="spinner-border spinner-border-sm d-none" id="spinnerSubirDoc"></span>
                    <i id="iconoSubirDoc" class="bi bi-cloud-arrow-up-fill me-2 mr-1"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Input oculto para la cámara -->
<input type="file" id="inputCamara" accept="image/*" capture="environment" class="d-none">
<!-- Fin Documentacion de despacho -->

    <!-- Info WiFi -->
    <div id="notification-ios-wifi" class="notification-ios-wifi">
        <img src="./Img/wifiLogi.gif" alt="WiFi Icon" class="wifi-icon-ios-wifi">
        <span id="notification-text-ios-wifi"><strong></strong>¡Conexión perdida!</strong><br>No se preocupe, cuando la conexión vuelva, la página se recargará automáticamente.</span>
        <span class="close-btn-ios-wifi" onclick="closeNotification()">✖</span>
        <button id="retry-button-ios-wifi" class="retry-button-ios-wifi" onclick="reloadPage()">Reintentar</button>
    </div>
        
    <script>
        let isOnline = navigator.onLine;
    
        function showNotification() {
            const notification = document.getElementById('notification-ios-wifi');
            notification.style.display = 'flex';
            notification.classList.add('blink');
            document.getElementById('notification-text-ios-wifi').innerHTML = '<strong class="LogiPaq-wifi">LogiPaq</strong><br><strong>¡Conexión perdida!</strong><br>No se preocupe, cuando la conexión vuelva, la página se recargará automáticamente.';
            document.getElementById('retry-button-ios-wifi').textContent = 'Reintentar';
        }
    
        function closeNotification() {
            const notification = document.getElementById('notification-ios-wifi');
            notification.style.display = 'none';
            notification.classList.remove('blink');
        }
    
        function reloadPage() {
            location.reload();
        }
    
        function checkConnection() {
            if (!navigator.onLine && isOnline) {
                isOnline = false;
                showNotification();
            } else if (navigator.onLine && !isOnline) {
                isOnline = true;
                document.getElementById('notification-text-ios-wifi').textContent = '¡Has recuperado la conexión WiFi!';
                document.getElementById('retry-button-ios-wifi').textContent = 'Cancelar';
            }
        }
    
        setInterval(checkConnection, 5000);
        window.addEventListener('offline', showNotification);
        window.addEventListener('online', reloadPage);
    </script>
    <!-- Fin info WiFi -->

    <!-- CHATBOT-->    
    <div class="circuloBot" id="bot">
        <img src="./bot/bot11-hello.gif" alt="Imagen" class="imagenBot">
    </div>
    <div class="chat" id="chat">
        <div class="chat-header">Logi-Chat 🗨️</div>
        <div class="chat-messageBot" id="chat-messageBot">
            <!-- Mensajes se añadirán aquí -->
        </div>
        <div class="chat-input-container">
            <input type="text" placeholder="Escribe un mensaje..." class="chat-input" id="chat-input">
            <button class="send-button" id="send-button">
                <i class="bi bi-send"></i> 
            </button>
        </div>
    </div> 
    <!-- CHATBOT-->
     
    <footer class="center">
        <img class="logo-foot" src="./Img/Novogar N.png" alt="Logo Novogar">
        <a class="www" href="https://novogar.com.ar/" target="_blank">NOVOGAR</a>
        <a href="https://novogar.com.ar/info/empresa" target="_blank">Quienes somos</a>
        <a href="https://novogar.com.ar/info/Sucursales" target="_blank">Sucursales</a>
        <a href="https://novogar.com.ar/info/ventaTelefonica" target="_blank">Atención al cliente</a>
        <button id="logoutButton" class="btn btn-danger mt-3"><i class="bi bi-person-gear mr-1"></i>Cerrar Sesión</button>
    </footer>   

    <!-- Firebase 8.x -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/print.js/1.6.0/print.min.js"></script>

    <!-- Scripts Bootstrap-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <!-- Bootstrap JS (versión compatible con Bootstrap 5.1.3) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- XLSX -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
        
    <!-- Cargar dompurify -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.4/purify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/printThis/1.15.0/printThis.min.js"></script>
    
    <!-- Cargar html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Cargar jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- BOT -->
    <script src="./js/firebase-init-Bot.js"></script>

    <!-- ExcelJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>

    <!-- Cargar FlatPickr -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

    <!-- TIPEO -->
    <script src="./js/features.js"></script>
    <script src="./js/ciudades.js"></script>
    <script src="./js/firebase-init-stock.js"></script>
    <script src="./js/firebase-init-Meli.js"></script>
    <script src="./js/firebase-init-tipeo.js"></script>
    <script src="./js/bot.js"></script>
    <script src="./js/tipeoWeb.js"></script>
    
</body>
</html>